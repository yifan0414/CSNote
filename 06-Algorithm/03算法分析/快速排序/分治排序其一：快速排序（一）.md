# 4.1 å¿«é€Ÿæ’åº

1. ä»åˆ†æ²»çš„è§’åº¦æ¥è¯´ï¼Œå¿«é€Ÿæ’åºæ˜¯ä¸€ç§å…¸å‹çš„**éš¾åˆ†æ˜“åˆå‹**çš„åˆ†æ²»ç®—æ³•ã€‚è¿™ç§åˆ†å‰²å­é—®é¢˜çš„æ”¾åœ¨åœ¨å¿«é€Ÿæ’åºä¹‹å¤–çš„å¾ˆå¤šåœºåˆéƒ½æœ‰é‡è¦çš„åº”ç”¨ã€‚
2. åœ¨å¿«é€Ÿæ’åºä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ†æ**æ’å…¥æ’åº**ã€‚æ´å¯Ÿ**æ’å…¥æ’åº**çš„æœ¬è´¨ï¼Œæ‰¾åˆ°å…¶ä¸è¶³ä¹‹å¤„åŠ ä»¥æ”¹è¿›

## 4.1.1 æ’åºé—®é¢˜æ˜¯ä»€ä¹ˆ

- è¾“å…¥ï¼šä¸€ç»„å„ä¸ç›¸åŒçš„ä¸¤ä¸¤å¯æ¯”è¾ƒçš„å…ƒç´  $\left \{a_1,a_2,\dots,a_n \right\}$ã€‚
    - å„ä¸ç›¸åŒï¼šç®€åŒ–åˆ†æ
    - ä¸¤ä¸¤å¯æ¯”è¾ƒï¼šæ¯ä¸ªå…ƒç´ ä¹‹é—´å…·æœ‰**ååºå…³ç³»**
- è¾“å‡ºï¼šè¾“å…¥å…ƒç´ çš„æŸä¸ªæ’åº $\left \{  a_{1}^{'} ,a_2^{'},\dots,a_n^{'} \right \}$ï¼Œæ»¡è¶³ $a_{1}^{'} <a_2^{'}<\dots<a_n^{'}$

è¿™é‡Œä¸»è¦è€ƒè™‘â€œåŸºäºæ¯”è¾ƒçš„æ’åºâ€ï¼Œè®¡ç®—æ¨¡å‹æä¾›äº†æ¯”è¾ƒå…ƒç´ å¤§å°çš„å…³é”®æ“ä½œ(critical operation)ï¼Œå¹¶ä¸”ç®—æ³•åªèƒ½ä½¿ç”¨è¯¥æ¯”è¾ƒæ“ä½œæ¥å†³å®šå…ƒç´ ä¹‹é—´çš„**åºã€‚**

## 4.1.2 æ’å…¥æ’åºçš„ä¸è¶³

> [!idea]+
> ğŸ’¡ çœ‹å‡ºè›®åŠ›ç®—æ³•çš„ä¸è¶³ä¸æ˜¯ä¸€ä»¶ç‰¹åˆ«ç®€å•çš„äº‹æƒ…ï¼Œä¸ºæ­¤å¯èƒ½éœ€è¦è®¾è®¡ä¸€ä¸ªä¸“é—¨çš„æ•°å­¦å·¥å…·å»å‘ç°è¿™ç§ä¸è¶³ï¼ˆæ”¾å¤§é•œğŸ”ï¼‰

æ’å…¥æ’åºåŸºäºéå†å®ç°ï¼Œå®ƒçš„æœ€åå’Œå¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦å‡ä¸º $O(n^2)$ã€‚ä½†ä»–è¿˜æœ‰æ”¹è¿›çš„ç©ºé—´

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›´æœ‰åŠ›çš„æ•°å­¦å·¥å…·æ¥åˆ†æè¿™ç§åŸºäºæ¯”è¾ƒçš„æ’åºï¼Œä¸ºæ­¤å®šä¹‰**é€†åºå¯¹ï¼ˆinversionï¼‰**çš„æ¦‚å¿µ

> [!quote]
> âœï¸ ç»™å®šä¸€ç»„å„ä¸ç›¸åŒçš„ä¸¤ä¸¤å¯æ¯”è¾ƒçš„å…ƒç´ ã€‚å¯¹äºè¿™äº›å…ƒç´ çš„ä¸€ä¸ªæ’åˆ— $\left \{  a_1,a_2,\dots,a_n \right \}$ è€Œè¨€ï¼Œå®šä¹‰äºŒå…ƒç»„ $(a_i,a_j)$ ä¸ºä¸€ä¸ªé€†åºå¯¹ï¼Œå¦‚æœ $i < j$ ï¼Œä¸” $a_i > a_j$ã€‚


åŸºäºé€†åºå¯¹çš„æ¦‚å¿µï¼Œæˆ‘ä»¬å¯ä»¥ç­‰ä»·åœ°æ¢ä¸€ä¸ªè§†è§’æ¥æè¿°æ’åºé—®é¢˜å’Œæ’åºç®—æ³•ã€‚

> **å¯¹äºè¾“å…¥çš„å¾…æ’åºå…ƒç´ åºåˆ—ï¼Œå®ƒåŒ…å«è‹¥å¹²ä¸ªé€†åºå¯¹ï¼Œè€Œæ’åºç®—æ³•åˆ™æ˜¯é€šè¿‡å…ƒç´ çš„æ¯”è¾ƒï¼Œè°ƒæ•´å…ƒç´ çš„ä½ç½®ï¼Œæ¶ˆé™¤è¾“å…¥åºåˆ—ä¸­çš„é€†åºå¯¹ã€‚
æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœä¸€ä¸ªç®—æ³•æ¶ˆé™¤é€†åºå¯¹çš„é€Ÿåº¦è¶Šå¿«â€”â€”é€šè¿‡æ›´å°‘çš„æ¯”è¾ƒå´èƒ½æ¶ˆé™¤æ›´å¤šçš„é€†åºå¯¹â€”â€”é‚£ä¹ˆè¿™ä¸ªç®—æ³•çš„æ•ˆç‡æ›´å¥½**

ä¸‹é¢æ˜¯æ’å…¥ç®—æ³•çš„æ¯”è¾ƒè¿‡ç¨‹ç¤ºæ„å›¾ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¯¥è¿‡ç¨‹ä¸­ï¼Œ**æ’å…¥ç®—æ³•æ€»æ˜¯å°†ç›¸é‚»çš„å…ƒç´ è¿›è¡Œæ¯”è¾ƒï¼Œæ¯ä¸€æ¬¡æ¯”è¾ƒï¼Œè‡³å¤šåªèƒ½æ¶ˆé™¤åºåˆ—ä¸­çš„ä¸€ä¸ªé€†åºå¯¹ã€‚**

![æ’å…¥æ’åºç®—æ³•å›¾è§£|500](https://picture-suyifan.oss-cn-shenzhen.aliyuncs.com/insertionSort.gif)

åŸºäºè¿™ä¸€æ€§è´¨ï¼Œæ’å…¥æ’åºçš„æœ€åæƒ…å†µå’Œå¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦å°±è½¬å˜ä¸ºåˆ†æåœ¨æœ€åå’Œå¹³å‡æƒ…å†µä¸‹è¾“å…¥åºåˆ—ä¸­æœ‰å¤šå°‘ä¸ª**é€†åºå¯¹ã€‚**

- æœ€åæƒ…å†µ
    - å¯¹äºä¸€ä¸ªä»å¤§åˆ°å°æ’åˆ—çš„å…ƒç´ åºåˆ—ï¼Œå…¶ä¸­ä»»æ„ä¸¤ä¸ªå…ƒç´ å‡æ„æˆé€†åºå¯¹ã€‚é€†åºå¯¹æ€»æ•°ä¸º $\displaystyle \binom{n}{2}=O(n^2)$ ã€‚
- å¹³å‡æƒ…å†µ
    - åœ¨æ‰€æœ‰å¯èƒ½çš„è¾“å…¥åºåˆ—ä¸­ï¼Œä¸€ä¸ªäºŒå…ƒç»„æœ‰ $\dfrac{1}{2}$ çš„æ¦‚ç‡æ„æˆäºŒå…ƒç»„ï¼Œæ‰€ä»¥å¹³å‡æƒ…å†µä¸‹é€†åºå¯¹çš„æ€»æ•°ä¸º $\displaystyle \frac{1}{2}\binom{n}{2}=O(n^2)$

## 4.1.3 å¿«é€Ÿæ’åºçš„æ”¹è¿›æ€æƒ³

å¦‚æœæƒ³è¦æ”¹è¿›æ’åºç®—æ³•çš„æ•ˆç‡ï¼Œå¿…é¡»ä¸€æ¬¡æ¯”è¾ƒèƒ½å¤Ÿæ¶ˆç­**å°½å¯èƒ½å¤šçš„é€†åºå¯¹**ã€‚æ ¹æ®é€†åºå¯¹çš„å®šä¹‰ï¼Œä¸€ä¸ªåå¤§çš„å…ƒç´ åº”è¯¥å°½é‡å¾€åæ”¾ï¼Œè¿™æ ·å®ƒå°±ä»¥æ›´å°çš„å¯èƒ½æ€§ä¸å…¶ä»–å…ƒç´ ç»„æˆé€†åºå¯¹ï¼›å¯¹å¶åœ°ï¼Œä¸€ä¸ªåå°çš„å…ƒç´ åº”è¯¥å°½é‡å¾€å‰æ”¾ã€‚æˆ‘ä»¬é¦–å…ˆé€‰æ‹©ä¸€ä¸ªåŸºå‡†å…ƒç´  `pivot` ï¼Œä»¥å®ƒä¸ºåŸºå‡†æ¥ç•Œå®šä¸€ä¸ªå…ƒç´ çš„å¤§å°ã€‚

>[!warning]
âœï¸ **Lomuto partition schemeï¼ˆç®—æ³•å¯¼è®ºçš„ç‰ˆæœ¬ï¼Œå¯¹äºé‡å¤å…ƒç´ æ€§èƒ½è¾ƒå·®ï¼‰**

```pseudo
\begin{algorithm}
\caption{PARTITION($A$, $p$, $r$)}
\begin{algorithmic}
    \State $pivot \gets A[r]$
    \State $i \gets p - 1$
    \For{$j \gets p$ \textbf{to} $r - 1$}
        \If{$A[j] < pivot$}
            \State $i \gets i + 1$
            \State SWAP($A[i], A[j]$)
        \EndIf
    \EndFor
    \State SWAP($A[i+1], A[r]$)
    \State \Return{$i + 1$}
\end{algorithmic}
\end{algorithm}
```

```pseudo
\begin{algorithm}
\caption{QUICK-SORT($A, p, r$)}
\begin{algorithmic}
\IF{$p < r$}
    \STATE $q \gets \text{PARTITION}(A, p, r)$
    \STATE QUICK-SORT($A, p, q - 1$)
    \STATE QUICK-SORT($A, q + 1, r$)
\ENDIF
\end{algorithmic}
\end{algorithm}
```


## 4.1.4 æœ€åæƒ…å†µæ—¶é—´å¤æ‚åº¦åˆ†æ

<aside>
ğŸ’¡ é—®é¢˜è§„æ¨¡çš„ç¼©å‡é€Ÿåº¦å’Œç®—æ³•çš„æ•ˆç‡åŠå…¶ç›¸å…³

</aside>

å¿«é€Ÿæ’åºç®—æ³•çš„æ€§èƒ½ä¸»è¦å— PARTITION è¿‡ç¨‹æ‰§è¡Œæ•ˆæœçš„å½±å“ã€‚å¯ä»¥ç”¨ä¸‹é¢çš„é€’å½’æ–¹ç¨‹è¿›è¡Œæè¿°ï¼š

$$
T(n)=T(a) +T(n-a)+O(n)
$$

å¯ä»¥å¾ˆæ¸…æ™°çš„çœ‹åˆ°ï¼ŒPARTITION çš„ç»“æœè¶Šä¸å‡è¡¡ï¼Œåˆ™æ’åºçš„æ€§èƒ½è¶Šå·®ã€‚å‡è®¾æ¯æ¬¡ PARTITION çš„ç»“æœéƒ½æä¸å‡è¡¡ï¼Œæ‰€æœ‰å…ƒç´ å‡æ¯”åŸºå‡†å…ƒç´ å°ï¼ˆæˆ–æ¯”åŸºå‡†å…ƒç´ å¤§ï¼‰ã€‚é€’å½’æ–¹ç¨‹å°±ä¼šå˜ä¸ºï¼š

$$
T(n)=T(n-1)+O(n)=O(n^2)
$$

å› æ­¤å¿«é€Ÿæ’åºåœ¨æœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$

æˆ‘ä»¬å¯ä»¥åšä¸€ä¸ªå¾ˆå–å·§çš„å‡è®¾ï¼ŒPARTITION çš„ç»“æœæ˜¯å®Œå…¨å‡è¡¡çš„ï¼Œæ¯æ¬¡éƒ½å¯ä»¥å°†é—®é¢˜åˆ†ä¸ºç­‰å¤§å°çš„ä¸¤åŠï¼Œé€’å½’æ–¹ç¨‹ä¸ºï¼š

$$
T(n) = 2T(\frac{n}{2})+O(n)
$$

æ ¹æ® [MASTER](https://www.notion.so/Master-c72f053098624da3b6561a8e8bcb8abf?pvs=21) å®šç†ï¼Œ$T(n) = O(n\,log\,n)$ã€‚

## 4.1.5 åŸºäºé€’å½’æ–¹ç¨‹çš„å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦åˆ†æ

<aside>
ğŸ’¡ é€’å½’ç®—æ³•ç”¨é€’å½’æ–¹ç¨‹å»æè¿°ï¼Œé€’å½’ç®—æ³•çš„ä»£ä»·ç”¨è§£é€’å½’æ–¹ç¨‹æ¥è·å¾—

</aside>

åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒPARTITION æ“ä½œå°† $n$ ä¸ªå…ƒç´ åˆ†å‰²æˆä¸‰ä¸ªéƒ¨åˆ†ï¼Œå·¦è¾¹éƒ¨åˆ†æœ‰ $i$ ä¸ªå…ƒç´  $(0\leqslant i \leqslant n-1)$ï¼Œä¸­é—´æ˜¯åŸºå‡†å…ƒç´ ï¼Œå³è¾¹éƒ¨åˆ†æœ‰ $n-1 -i$ ä¸ªå…ƒç´ ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ 

![æœªå‘½åç»˜å›¾.svg](https://picture-suyifan.oss-cn-shenzhen.aliyuncs.com/%E6%9C%AA%E5%91%BD%E5%90%8D%E7%BB%98%E5%9B%BE.svg)

<center>PARTITION çš„ä¸€èˆ¬æƒ…å†µ</center>

å‡è®¾æ‰€æœ‰å¯èƒ½çš„è¾“å…¥ä»¥**ç›¸åŒ**çš„æ¦‚ç‡å‡ºç°ï¼Œåˆ™æ‰€æœ‰å¯èƒ½çš„åˆ’åˆ†æƒ…å†µä»¥ç›¸åŒçš„æ¦‚ç‡å‡ºç°ï¼Œå³ $i$ ä»¥ç›¸åŒçš„æ¦‚ç‡å–åŒºé—´ $[0,n-1]$ ä¸­çš„æ¯ä¸€ä¸ªå€¼ï¼Œç®—æ³•çš„å¹³å‡æ—¶é—´å¤æ‚åº¦ $A(n)$ æ»¡è¶³ï¼š

$$
A(n)=\underbrace{n-1}_{ {\small PARTITION}  çš„ä»£ä»·} + \underbrace{\sum_{i=0}^{n-1} \frac{1}{n}\left[ A(i) + A(n-1-i) \right]}_{é€’å½’æ’åºå·¦ã€å³éƒ¨åˆ†çš„ä»£ä»·}, n \ge2 
$$

é€’å½’çš„åˆå§‹æƒ…å†µä¸ºï¼š$A(1)=A(0)=0$ï¼Œä¸”å·¦å³éƒ¨åˆ†çš„ä»£ä»·å…·æœ‰å¯¹ç§°æ€§ï¼Œå³

$$
\sum_{i=0}^{n-1}A(i)=\sum_{i=0}^{n-1}A[(n-1)-i]
$$

æ‰€ä»¥ï¼Œé€’å½’æ–¹ç¨‹å¯ä»¥æ”¹å†™ä¸ºï¼š

$$
A(n)=(n-1)+\frac{2}{n}\sum_{i=0}^{n-1}A(i),\;\;n\geqslant2
$$

### è§£æ³• 1ï¼šGuess and Prove

é€’å½’æ–¹ç¨‹çš„æ±‚è§£ä¸€å…±åŒ…å« $3$ ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ï¼š

- ç¬¨å±•å¼€
- Guess and Proveï¼ˆæ›¿æ¢æ³•ï¼‰
- åˆ†æ²»é€’å½’ä¸é€’å½’æ ‘

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹ä¸‹é¢çš„é€’å½’æ–¹ç¨‹ä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•è¿›è¡Œåˆ†æã€‚

Guess and Prove çš„ç¬¬ä¸€æ­¥å°±æ˜¯ Guessï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªæ¯”è¾ƒå®ç”¨çš„å“²ç†å°±æ˜¯ï¼š

>[!Idea] 
>ğŸ’¡ **A special case as the clue for a smart guess**
<aside>


</aside>

å¯¹äºå¿«é€Ÿæ’åºçš„å¹³å‡æƒ…å†µå¤æ‚åº¦æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥åˆç†çš„å‡è®¾æ¯æ¬¡çš„ pivot éƒ½æ°å¥½å°†æ•´ä¸ªåºåˆ—åˆ†ä¸ºç›¸ç­‰çš„ä¸¤éƒ¨åˆ†ï¼Œè¿™æ · $A(n)$ å°±æ»¡è¶³ä¸‹é¢çš„å…³ç³»å¼
$$
A(n) \approx 2A(\frac{n}{2})+n
$$
æ ¹æ® Master å®šç† [Master å®šç†](https://www.notion.so/Master-c72f053098624da3b6561a8e8bcb8abf?pvs=21) ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°

$$
A(n) \in \Theta(n\log n)
$$

æ ¹æ®å‡½æ•°çš„æ¸è¿›å¢é•¿ç‡çš„æ€§è´¨ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°

$$
\begin{aligned}
A(n) \in \Theta(n\log n) &\iff A(n) \in O(n\log n) \cap A(n) \in \Omega (n \log n) \\
&\iff A(n) \in O(n\ln n) \cap A(n) \in \Omega (n \ln n)
\end{aligned}
$$

-  **Inductive Proof:** $A(n) \in O(n\ln n)$ 
	- Theorem: $A(n) \le cn\log n$ for some constant c, with $A(n)$ defined by the recurrence equation above.
	- Proof: 
		- By induction on $n$, the number of elements to be sorted. Base case (n=1) is trivial.
		- Inductive assumption: $A(i) \le ci\ln i \text{  for } 1 \le i < n$

$$
    A(n)=(n-1)+\frac{2}{n} \sum_{i=1}^{n-1} A(i) \leq(n-1)+\frac{2}{n} \sum_{i=1}^{n-1} c i \ln i
$$

Note:
$$
    \frac{2}{n} \sum_{i=1}^{n-1} c i \ln i \leq \frac{2 c}{n} \int_1^n x \ln x d x \approx \frac{2 c}{n}\left(\frac{n^2 \ln n}{2}-\frac{n^2}{4}\right)=c n \ln n-\frac{c n}{2}
$$
So, 
    
$$
    A(n) \leq c n \ln n+n\left(1-\frac{c}{2}\right)-1
$$

Let $c=2$, we have $A(n) \le 2n \ln n$

 - **Inductive Proof:** $A(n) \in \Omega(n\ln n)$
	- Theorem: $A(n)â‰¥cnlnn$  for some constant c, with large n
	- Inductive reasoning:

$$
\begin{aligned}&A(n)=(n-1)+\frac{2}{n} \sum_{i=1}^{n-1} A(i) \geq(n-1)+\frac{2}{n} \sum_{i=1}^{n-1} c i \ln i \\&=(n-1)+\frac{2 c}{n} \sum_{i=2}^n i \ln i-2 c \ln n \geq(n-1)+\frac{2 c}{n} \int_1^n x \ln x d x-2 c \ln n \\&\approx c n \ln n+\left[(n-1)-c\left(\frac{n}{2}+2 \ln n\right)\right]\end{aligned}
$$

Let $c<\dfrac{n-1}{\frac{n}{2}+2 \ln n}$, then $A(n) > cn \ln n$ (Note: $\displaystyle\lim _{n \rightarrow \infty} \dfrac{n-1}{\frac{n}{2}+2 \ln n}=2$)

### è§£æ³• 2: Directly Derived Recurrence Equation


ğŸ’¡ è€ƒè™‘å­é—®é¢˜ä»£ä»·æ±‚å’Œéƒ¨åˆ†ï¼Œæˆ‘ä»¬å‘ç°å¯¹äºä¸åŒè§„æ¨¡çš„ $n$ï¼Œ**å­é—®é¢˜æ±‚å’Œéƒ¨åˆ†æœ‰å¾ˆå¤šé‡å **ã€‚è¿™å¯å‘æˆ‘ä»¬å¯ä»¥ä½¿ç”¨â€œé”™ä½ç›¸å‡â€çš„æ–¹æ³•æ¥æ¨å¯¼ä¸åŒè§„æ¨¡çš„ $A(n)$ ä¹‹é—´çš„å…³ç³»ã€‚

$$
{\small \begin{align*} nA(n)-(n-1)A(n-1) & = n(n-1)+{2}\sum_{i=1}^{n-1}A(i)-(n-1)(n-2)-2\sum_{i=1}^{n-2}A(i) \\ & =2A(n-1)+2(n-1) \end{align*}}
$$

æ‰€ä»¥ï¼š

$$
\begin{align*} nA(n) &=(n+1)A(n-1)+2(n-1) \\\dfrac{A(n)}{n +1 } &= \dfrac{A(n-1)}{n} + \dfrac{2(n-1)}{n(n+1)} \end{align*}
$$

ä»¤ $\dfrac{A(n)}{n+1}=B(n)$ï¼Œåˆ™ï¼š

$$
B(n)=B(n-1)+\dfrac{2(n-1)}{n(n+1)}
$$

é€’å½’å¼ $B(1)=B(0)=0$ ï¼Œç›´æ¥å¯¹é€’å½’å¼ $B(n)$ è¿›è¡Œå±•å¼€å¯ä»¥å°† $B(n)$ çš„é€’å½’å¼è½¬æ¢ä¸ºæ±‚å’Œå¼ï¼š

$$
\begin{align*}
B(n) &= \sum_{i=1}^{n}\frac{2(i-1)}{i(i+1)} \\
&=2\sum_{i=1}^{n}\frac{i +1-2}{i(i+1)} \\
&=2\sum_{i=1}^{n}\frac{1}{i}-4\sum_{i=1}^{n}\frac{1}{i(i+1)} \\
&=4\sum_{i=1}^{n}\frac{1}{i+1} -2\sum_{i=1}^{n}\frac{1}{i}
\\&=4\sum_{i=2}^{n+1}\frac{1}{i}-2\sum_{i=1}^{n}\frac{1}{i}
\\ &=2\sum_{i=1}^{n} \frac{1}{i} - 4 + 4\frac{1}{n+1}
\\ &=2\sum_{i=1}^{n}\frac{1}{i} - \frac{4n}{n+1} \\
&=2\ln n -4 \\
&=1.39\log n
\\&=O(log\,n)
\end{align*}
$$

- å¦ä¸€ç§é€‰æ‹©
  
  $$
\begin{aligned}C(n)=& n-1+\frac{1}{n} \sum_{i=0}^{n-1}(C(i)+C(n-i-1))=n-1+\frac{2}{n} \sum_{i=0}^{n-1} C(i) \\n C(n) &=n(n-1)+2 \sum_{i=0}^{n-1} C(i) \\n C(n) &-(n-1) C(n-1)=n(n-1)-(n-1)(n-2)+2 C(n-1) \\n C(n) &=(n+1) C(n-1)+2 n-2 \\\frac{C(n)}{n+1} &=\frac{C(n-1)}{n}+\frac{2}{n+1}-\frac{2}{n(n+1)} \leq \frac{C(n-1)}{n}+\frac{2}{n+1} \\&=\frac{C(n-2)}{n-1}+\frac{2}{n}-\frac{2}{(n-1) n}+\frac{2}{n+1} \leq \frac{C(n-2)}{n-1}+\frac{2}{n}+\frac{2}{n+1} \\& \vdots \quad \\&=\frac{C(1)}{2}+\sum_{i=2}^n \frac{2}{i+1} \leq 2 \sum_{i=1}^{n-1} \frac{1}{i} \approx 2 \int_1^n \frac{1}{x} \mathrm{~d} x=2 \ln n\end{aligned}
$$
    

æ‰€ä»¥ $A(n)=O(nlog\,n)$

## 4.1.6 åŸºäºæŒ‡æ ‡éšæœºå˜é‡çš„å¹³å‡æƒ…å†µæ—¶é—´å¤æ‚åº¦åˆ†æ

## ä¹ é¢˜ 1 (sist 2019 991 7)

1. Suppose a version of QuickSort always chooses the ***left-most*** element in an array to be the pivot. Give a worst-case input array of size n for this QuickSort algorithm, represented as a permutation of all integers in set {1, 2, ..., n}. Derive the asymptotic time complexity of the algorithm on this input in terms of $\Theta$. (<font color="#c00000">8 points</font>)

2. As a recursive algorithm, QuickSort tends to call itself for many small subarrays, which would compromise the time efficiency. It is known that the Insertion sort algorithm is fast on small input arrays. Describe a method to modify the QuickSort algorithm by using Insertion sort, such that the above issue can be addressed. Suppose each subarray on which Insertion sort is applied has no more than k elements. Show that the modified algorithm has average-case time complexity of $O(nk + nlog(n / k))$. (<font color="#c00000">9 points</font>)

**è§£**ï¼š

ä¸å¤ªä¸¥æ ¼çš„å¹³å‡æ—¶é—´å¤æ‚åº¦åˆ†æå°±æ˜¯ç”»**é€’å½’æ ‘**ï¼Œä¸¥æ ¼çš„æ•°å­¦æ¨å¯¼ï¼ˆä¾‹å¦‚ 4.1.5ï¼‰è¿˜æ²¡æœ‰æ¨å¯¼å‡ºæ¥ã€‚
ä¸‰ç§æ–¹æ³•ï¼šç¬¨å±•å¼€ï¼Œguess and proveï¼Œåˆ†æ²»é€’å½’ä¸é€’å½’æ ‘

3.Suppose that QuickSort uses the median of E[first], E[middle] and E[last] as the pivot. Show that the number of comparisons between array elements performed by this QuickSort algorithm is no more than $\dfrac{n^2}{4}+o(n^2)$ in the worst case. (8 points)
````tabs

tab: math
$$
\begin{aligned}C(n)=& n-1+\frac{1}{n} \sum_{i=0}^{n-1}(C(i)+C(n-i-1))=n-1+\frac{2}{n} \sum_{i=0}^{n-1} C(i) \\n C(n) &=n(n-1)+2 \sum_{i=0}^{n-1} C(i) \\n C(n) &-(n-1) C(n-1)=n(n-1)-(n-1)(n-2)+2 C(n-1) \\n C(n) &=(n+1) C(n-1)+2 n-2 \\\frac{C(n)}{n+1} &=\frac{C(n-1)}{n}+\frac{2}{n+1}-\frac{2}{n(n+1)} \leq \frac{C(n-1)}{n}+\frac{2}{n+1} \\&=\frac{C(n-2)}{n-1}+\frac{2}{n}-\frac{2}{(n-1) n}+\frac{2}{n+1} \leq \frac{C(n-2)}{n-1}+\frac{2}{n}+\frac{2}{n+1} \\& \vdots \quad \\&=\frac{C(1)}{2}+\sum_{i=2}^n \frac{2}{i+1} \leq 2 \sum_{i=1}^{n-1} \frac{1}{i} \approx 2 \int_1^n \frac{1}{x} \mathrm{~d} x=2 \ln n\end{aligned}
$$
tab: emath2
$$
\begin{align*}
B(n) &= \sum_{i=1}^{n}\frac{2(i-1)}{i(i+1)} \\
&=2\sum_{i=1}^{n}\frac{i +1-2}{i(i+1)} \\
&=2\sum_{i=1}^{n}\frac{1}{i}-4\sum_{i=1}^{n}\frac{1}{i(i+1)} \\
&=4\sum_{i=1}^{n}\frac{1}{i+1} -2\sum_{i=1}^{n}\frac{1}{i}
\\&=4\sum_{i=2}^{n+1}\frac{1}{i}-2\sum_{i=1}^{n}\frac{1}{i}
\\ &=2\sum_{i=1}^{n} \frac{1}{i} - 4 + 4\frac{1}{n+1}
\\ &=2\sum_{i=1}^{n}\frac{1}{i} - \frac{4n}{n+1} \\
&=2\ln n -4 \\
&=1.39\log n
\\&=O(log\,n)
\end{align*}
$$
````