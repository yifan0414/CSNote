---
创建时间: 2024-08-03 17:54
难度: ⭐️⭐️⭐️
URL: 
tags: 
time:
---

## 题目描述

帅帅经常跟同学玩一个矩阵取数游戏：对于一个给定的 $n \times m$ 的矩阵，矩阵中的每个元素 $a_{i,j}$ 均为非负整数。游戏规则如下：

1. 每次取数时须从每行各取走一个元素，共 $n$ 个。经过 $m$ 次后取完矩阵内所有元素；
2. 每次取走的各个元素只能是该元素所在行的行首或行尾；
3. 每次取数都有一个得分值，为每行取数的得分之和，每行取数的得分 = 被取走的元素值 $\times 2^i$，其中 $i$ 表示第 $i$ 次取数（从 $1$ 开始编号）；
4. 游戏结束总得分为 $m$ 次取数得分之和。

帅帅想请你帮忙写一个程序，对于任意矩阵，可以求出取数后的最大得分。

## 输入格式

输入文件包括 $n+1$ 行：

第一行为两个用空格隔开的整数 $n$ 和 $m$。

第 $2\sim n+1$ 行为 $n \times m$ 矩阵，其中每行有 $m$ 个用单个空格隔开的非负整数。

## 输出格式

输出文件仅包含 $1$ 行，为一个整数，即输入矩阵取数后的最大得分。

## 样例 #1

### 样例输入 #1

```
2 3
1 2 3
3 4 2
```

### 样例输出 #1

```
82
```

## 提示

**【数据范围】**

对于 $60\%$ 的数据，满足 $1\le n,m\le 30$，答案不超过 $10^{16}$。  
对于 $100\%$ 的数据，满足 $1\le n,m\le 80$，$0\le a_{i,j}\le1000$。

**【题目来源】**

NOIP 2007 提高第三题。

## 思路

首先考虑这样一个问题：

```txt
876 100 200 2 1 920
```

- 每次取走的各个元素只能是行首或行尾；
- 取数的得分 = 被取走的元素值 $\times 2^i$，其中 $i$ 表示第 $i$ 次取数（从 $1$ 开始编号）；

怎么才能得到最大值。
首先，贪心是不行的。
$$
\begin{align}
s &= 876 * 2^1 + 100 * 2^2 + 200* 2^3 + 2* 2^4+1*2^5+920* 2^6 \\
&=62696
\end{align}
$$
小于
$$
\begin{align}
s &= 920 * 2^1 + 1 * 2^2 + 2 * 2^3 + 200 * 2^4 + 100 *2^5+ 876* 2^6 \\
&= 64324
\end{align}
$$
