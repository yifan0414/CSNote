> [!quote] 计算机科学领域的任何问题都可以通过增加一个间接的中间层来解决，计算机整个体系从上到下都是按照严格的层次结构设计的。
#### 1 为什么 TCP 的连接建立需要 3 次握手，而不是 2 次握手
TCP 采用三次握手而不是两次握手，主要是为了防止已失效的连接请求突然传送到服务器，**导致服务器资源浪费**
考虑这个情况，客户端发送了一个连接请求报文 A，但该报文在网络中滞留了一段时间，导致该报文段的超时重传，**所以客户端用发送了连接请求 B，服务器收到 B 后，返回一个确认报文段 C，然后直到释放连接。** 此时，服务器收到了最初的报文 A，误以为是客户端发送的新请求，就发送了确认报文段并且处于**连接已建立阶段**，而此时客户端并没有发送，**对此不会理会**，就会导致资源浪费。

#### 2 为什么 TCP 的连接释放需要 4 次挥手，而不是 3 次挥手
老师好，TCP 采用 **四次挥手 + 2MSL 等待**，而不是 **三次挥手直接关闭**，主要是为了 **确保双方的数据都正确传输，避免旧连接影响新连接**。

1. **四次挥手** 是因为 TCP 是全双工通信，**双方都要单独关闭** 自己的发送通道，不能简单地像握手一样合并。

2. **等待 2MSL** 是为了 **确保最后的 ACK 能被对方收到**，如果丢失了，服务器还会重发 FIN，客户端能重新应答。

考虑这种情况，客户端在第 4 次挥手后，没有等 2MSL(Maximum Segment Lifetime)，直接进入关闭状态，那么如果该报文在传输过程中丢失，服务器没有收到第 4 次挥手的报文，则第三次挥手的报文（tcp 连接释放报文段）会被重传，而此时客户端已经关闭，即收不到这个报文，那么服务器会进入无限重传，且处于最后确认阶段，无法进入关闭状态


### 3 为什么是 4 次挥手和 3 次握手

在 **三次握手** 时，**SYN 和 ACK 可以合并**，因为 **连接建立时，双方都是”主动”的**，同时希望建立连接，所以可以同步确认。

但在 **四次挥手** 时，**连接的释放是”逐步”进行的**：
1. **主动关闭方** 发送 **FIN**（表示“我不再发送数据”）。
2. **被动关闭方** 回复 **ACK**（表示“我知道了，但我可能还有数据要发送”）。
3. **被动关闭方** 发送 **FIN**（表示“我也不再发送数据”）。
4. **主动关闭方** 回复 **ACK**（最终确认，连接彻底关闭）。

由于 **被动关闭方可能还有数据未发送完**，所以它 **不能立即发送 FIN**，而需要等数据传输完成后才关闭。因此，**ACK 和 FIN 不能合并**，必须拆成 **四次挥手**，保证双方都安全地关闭通信。

#### 4 名词解释

1. **路由选择**：按照复杂的分布式算法，根据从各相邻路由器所得到的关于整个网络拓扑中的变化情况，动态地改变所选择的路由

2. **分组转发**：指路由器根据转发表将用户的 IP 数据包从合适的端口发送出去

3. **TCP 流量控制**：发送方根据 **接收方的窗口大小** 调整发送速率，**防止接收方处理不过来**。

4. **拥塞**：网络中出现过量的分组，**导致队列溢出、丢包、延迟增大**，影响通信质量，引起网络性能下降。

5. **TCP 拥塞控制**：发送方 **根据网络状态** 动态调整发送速率，**防止网络负载过重**，常见算法有 **慢启动、拥塞避免、快重传、快恢复**。

6. **计算机网络**：多个计算设备 **通过通信介质互联**，进行 **数据传输和资源共享** 的系统。
	- 5 个功能：数据通信、资源共享、分布式处理、提高可靠性、负载均衡

7. **信道带宽**：信道中能够传送信号的最大频率范围，如果信号的带宽小于信道的带宽，则输入信号的全部频率分量都能通过信道，反之，则部分频率分量将不能通过信道

8. **计算机网络协议**：计算机网络中用于规定信息的格式以及如何发送和接收消息的一套规则称为网络协议或通信协议，由语法、语义、同步组成。
	- 语法：定义了传输数据的格式
	- 语义：会定了所要完成的功能，即需要发出何种控制信息，完成何种动作以及做出何种应答
	- 同步：规定了执行各种操作的条件、时序关系等。

9. **基带传输**：在数字信道上直接传送基带信号，不需要调制解调器，**常用于局域网**。
	- 老师好，**基带传输** 是指 **在数字信道上直接传输数字信号**，而**不经过调制**。具体来说，在 **局域网（LAN）** 里，数据是以 **0 和 1 的数字信号** 直接在网线等传输介质上传播的，不像电话网那样需要调制成模拟信号再传输。所以 **基带传输不需要调制解调器（Modem）**。**常见的例子** 就是 **以太网（Ethernet）**，它采用 **基带信号** 在双绞线上直接传输数据。相比于需要调制的 **宽带传输（如 ADSL）**，基带传输的距离一般较短，但**信号质量高、抗干扰能力强**，适用于**短距离高速数据通信**。
10. **动态路由**：路由器**自动学习网络拓扑**，根据实时情况**动态调整最优路径**，比如 **RIP、OSPF、BGP**。

11. **局域网（LAN）**：是一种在有限的地理范围内将大量pc机及各种设备互联在一起，实现数据传输和资源共享的计算机网络。其特性由三个要素决定：**拓扑结构、传输介质、介质访问控制**（最主要的）

12. **无线局域网（WLAN）**：一种短距离无线通信组网技术，它是以**无线信道**为**传输介质**构成的计算机网络，通过无线电传播技术来实现在空间传输数据，常见标准是 **802.11**。

13. **虚拟局域网（VLAN）**：在一个物理网络上**划分逻辑子网**，提高安全性和管理效率。

14. **面向连接的网络服务**：面向连接服务在数据在交换之前，必须先建立连接。当数据交换结束后，则终止这个连接。具有连接建立、数据传输、连接释放三个阶段，是**可靠的报文分组按顺序传输方式**。

15. **TCP/IP**：tcp/ip协议是当今技术最成熟、应用广泛的网络传输协议，并拥有完整的体系结构和协议标准，互联网的核心协议 **TCP 负责可靠传输，IP 负责寻址和转发**。

16. **FTP（文件传输协议）**：是互联网提供的一项基本服务，利用这个协议可以方便地在两台连网计算机间传输文件，比如浏览器中下载某个文档等，都是用 FTP
	- 也是 TCP 的，只提供文件传输，主要是为了减少不同操作系统下处理文件的不兼容性  
	- FTP屏蔽了各计算机系统的细节，因而适合于在异构网络中任意计算机之间传送文件 
	- 工作步骤：  
	    1. 打开21端口，让客户进程可以连上  
	    2. 等待客户进程发出连接请求  
	    3. 启动从属进程来处理客户进程发来的请求。从属进程对客户进程的请求处理完毕后即终止。但一个 FTP服务器进程可以为多个客户端进程服务。从属进程在运行期间根据需要还可能创建其他一些子进程  
	    4. 回到等待状态，继续接受其他客户进程发来的请求。主进程和从属进程的处理都是并发进行的

17. **WWW（万维网）**：基于 HTTP 协议的全球信息系统，**浏览器访问的网页都属于 WWW**。
    - 是一个分布式、联机式的信息存储空间  
	- 提供分布式服务      
	- 工作方式：  
	    1. 以客户——服务器方式工作  
	    2. 浏览器——用户计算机上的万维网客户程序，万维网文档驻留的计算机则运行服务器程序，因此这个计算机也叫万维网服务器  
	    3. 客户程序向服务器发出请求，服务器返回客户所要的文档，然后客户解析后出现页面  
	- 解决的问题：如何标识各种文档？答：用 URL，且可以唯一标识  
	- 解决的问题：用啥协议实现万维网的超链接？答：HTTP，客户程序和服务器程序之间交互必须遵守的协议  
	- 解决的问题：怎样使各种万维网文档都能在因特网上的各种计算机显示出来？答：HTML（超文本标记语言）  
	- 解决的问题：怎么样使用户很方便地找到所需信息？答：搜索引擎

18. **URL（统一资源定位符）**：统一资源定位符，负责标识万维网上的各种文档，并使每个文档在整个万维网的范围内具有唯一的标识符 URL

19. **HTTP（超文本传输协议）**：一个面向事务的应用层协议，使用 TCP 连接进行可靠的传输，是客户程序和服务器程序之间交互必须遵守的协议
	- 工作流程：
	    - 浏览器分析指向页面的url
	    - 浏览器向dns请求解析该url的IP地址
	    - dns解析出url的ip地址
	    - 浏览器与该服务器建立tcp连接
	    - 浏览器发送http的get请求
	    - 服务器通过http响应把index.html发送给浏览器
	    - 释放tcp连接
	    - 浏览器解析index.html，并将页面显示在浏览器上

20. **SMTP（简单邮件传输协议）**：用于 **发送邮件**，默认端口 **25**，但现在常用 **465（SSL 加密）**。
	- 是一个发送邮件的协议，规定了两个相互通信的 smtp 进程应该如何交换信息  
	- 三个阶段：建立连接、邮件传送、连接释放

21. **代理服务器**：也叫万维网高速缓存，它可以代表浏览器发出 HTTP 请求，一般是把最近的一些请求和响应暂存本地磁盘中，就如何这个请求有被记录，则直接响应，不需要按 URL 的地址去因特网访问该资源

22. **POP3（邮局协议 3）**：**下载邮件到本地**，不默认保留服务器副本，端口 **110**。
	- 是一个邮件读取协议，当用户读取邮件时，用户代理向邮件服务器发送请求，拉取用户邮箱的邮件  
	- why 使用 pop3？答：收信人不需要参与到与邮件服务器之间的邮件读取过程，简化了用户操作  
	- pop 支持离线邮件处理，提供了ssl加密的时pop3s  
	- 这种离线访问模式是一种存储转发服务  
	- pop3已经可以“只下载邮件，服务端不删除了”，pop不行  
	- 三种状态：AUTHORIZATION（授权），TRANSACTION（处理），UPDATE（更新）
	
23. **IMAP（互联网邮件访问协议）**：**邮件保留在服务器**，可以多设备同步访问，端口 **143**（或 993 加密）。
	- IMAP 改进了 POP3 的不足，**用户可以通过浏览信件头来决定是否收取、删除和检索邮件的特定部分**  
	- **还可以在服务器上创建或更改文件夹或邮箱。它除了支持 POP3协议的脱机操作模式外，还支持联机操作和断连接操作**  
	- 它为用户提供了有选择的从邮件服务器接收邮件的功能、基于服务器的信息处理功能和共享信箱功能  
	- IMAP4 的脱机模式不同于 POP3，它不会自动删除在邮件服务器上已取出的邮件，其联机模式和断连接模式也是将邮件服务器作为“远程文件服务器”进行访问，更加灵活方便  
	- IMAP 是一个联机协议，可以在不同的地方使用不同的计算机阅读和处理自己的邮件

24. IMAP和POP3的区别
	- pop3允许电子邮件客户端离线下载服务器上的邮件，但是在客户端的操作（移动邮件、标记已读）不会反馈到服务器上。  
	- 而 imap 是提供 webmail 与电子邮件客户端之间的双向通信，因为是联机协议，可以维护会话用户的状态信息，是可以反馈到服务器的  
	- imap 还支持从多个不同设备中随时访问新邮件  
	- 用户可以通过浏览信件头来决定是否收取、删除和检索邮件的特定部分